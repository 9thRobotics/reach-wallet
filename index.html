let provider, web3Provider, signer, selectedAccount;

const walletConnectProvider = new window.WalletConnectProvider.default({
  infuraId: process.env.INFURA_ID || "your-infura-id"
});

const coinbaseWalletProvider = new window.CoinbaseWalletSDK({
  appName: "ReachToken Portal",
  infuraId: process.env.INFURA_ID || "your-infura-id"
});

async function connectInjected(type) {
  if (typeof window.ethereum === "undefined") {
    showError("No wallet found. Install MetaMask or Trust Wallet.");
    return;
  }

  try {
    provider = window.ethereum;
    await provider.request({ method: "eth_requestAccounts" });
    web3Provider = new ethers.providers.Web3Provider(provider);
    signer = web3Provider.getSigner();
    selectedAccount = await signer.getAddress();
    updateUI("Connected", `‚úÖ Connected: ${selectedAccount}`);
  } catch (e) {
    console.error("Connection error:", e);
    updateUI("Failed", "‚ùå Failed to connect.");
  }
}

async function connectWalletConnect() {
  try {
    await walletConnectProvider.enable();
    web3Provider = new ethers.providers.Web3Provider(walletConnectProvider);
    signer = web3Provider.getSigner();
    selectedAccount = await signer.getAddress();
    updateUI("Connected", `‚úÖ Connected via WalletConnect: ${selectedAccount}`);
  } catch (err) {
    console.error("WalletConnect error:", err);
    showError("WalletConnect connection failed.");
  }
}

async function connectCoinbase() {
  try {
    const cbProvider = coinbaseWalletProvider.makeWeb3Provider(
      "https://mainnet.infura.io/v3/" + process.env.INFURA_ID,
      1
    );
    web3Provider = new ethers.providers.Web3Provider(cbProvider);
    signer = web3Provider.getSigner();
    selectedAccount = await signer.getAddress();
    updateUI("Connected", `‚úÖ Connected via Coinbase: ${selectedAccount}`);
  } catch (e) {
    console.error("Coinbase connect error:", e);
    showError("Coinbase connection failed.");
  }
}

function disconnectWallet() {
  provider = null;
  web3Provider = null;
  signer = null;
  selectedAccount = null;
  updateUI("Disconnected", "üîå Wallet disconnected.");
}

function showError(message) {
  alert(message);
  document.getElementById("status").innerText = message;
}

function updateUI(status, message) {
  document.getElementById("status").innerText = message;
  document.getElementById("buyButton").style.display =
    status === "Connected" ? "inline-block" : "none";
  document.getElementById("disconnectButton").style.display =
    status === "Connected" ? "inline-block" : "none";
}

// Add more logic for token purchase, calculations, etc.
